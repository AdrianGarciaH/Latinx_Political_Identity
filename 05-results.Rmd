# Results

```{r}
#Setup
library(tidyverse)
library(patchwork)
library(vcd)
library(ggalluvial)
```


```{r}
#Inital Data exploration
#3030 observations of 110 variables 
library(haven)
dataset = read_sav("ATP W58.sav")

dataset2 <-  dataset[ , c(1,8,10,11,12,13,14,15,16,17,18,19,21,22,23,32,39,40,41,42,43,44,49,50,51,52,63,64,65,66,67,69,70,71,72,73,74,75,78,79,80,81,82,83,84,85,86,87,88,89,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,110)] 

ds= as_factor(dataset2)
#Age distribution

ds %>%
  filter(F_AGECAT != 'Refused')%>%
  ggplot(aes(F_AGECAT)) + 
  geom_bar(color = "grey50", fill = "lightblue", width = 1) + theme_grey(16)

```



```{r}
#Initial Data exploration for Question 2: Does experiencing discrimination based on ethnic identity lead to more liberal political views? For example, do people who have experienced discrimination more easily embrace gender-neutral ways of expressing the Latin experience?

```
```{r}
#Graph of discrimination versus party preference 
table_ds1 <- ds %>%
  group_by(HISPDISCR_f_W58, F_PARTY_FINAL) %>%
  filter(HISPDISCR_f_W58 != 'Refused',F_PARTY_FINAL != 'Refused', F_PARTY_FINAL != 'Something else') %>%
  ungroup()
  
mosaic(F_PARTY_FINAL ~ HISPDISCR_f_W58,
       data = table_ds1,
       direction = c("v", "h"),
       highlighting_fill = RColorBrewer::brewer.pal(3, "Blues"),
       spacing = spacing_equal(sp = unit(0, "lines")),
       labeling = labeling_border(rot_labels = c(0, 0, 0, 0),
                                  set_varnames = c(HISPDISCR_f_W58 = "Have you expereinced discrimination?", F_PARTY_FINAL = "Party\nPreference"))) +
  theme_grey(16)

```




```{r}
#Graph of people who have heard term Latinx

ds %>%
  filter(LATINX1_W58 != 'Refused') %>%
  ggplot(aes(LATINX1_W58)) + 
  geom_bar(color = "grey50", fill = "lightblue", width = 1) + 
  ylab("Count") + 
  xlab("Response") +
  ggtitle("Have you heard of the term 'Latinx'?") +
  theme_grey(16)

```

```{r}
#Of those who have heard of the term Latinx:

#discriminated against vs. Latinx usage
table_ds4 <- ds %>%
  filter(LATINX1_W58 == 'Yes', HISPDISCR_f_W58 != 'Refused', LATINX3_W58 != 'Refused') %>%
  group_by(LATINX3_W58, HISPDISCR_f_W58)%>%
  summarize(n = n()) %>%
  mutate(prop = n/sum(n))
  
ggplot(table_ds4, aes(x=LATINX3_W58, y= prop, fill = HISPDISCR_f_W58)) +geom_col() +
  theme_grey(16)
  

#discriminated against vs belief that Latinx should be used to describe the latino population

table_ds5 <- ds %>%
  filter(LATINX1_W58 == 'Yes', HISPDISCR_f_W58 != 'Refused', LATINX4_W58 != 'Refused') %>%
  group_by(LATINX4_W58, HISPDISCR_f_W58)%>%
  summarize(n = n()) %>%
  mutate(prop = n/sum(n))

ggplot(table_ds5, aes(x=LATINX4_W58, y= prop, fill = HISPDISCR_f_W58)) +geom_col() +
  theme_grey(16)

```


```{r}
ds1 = select(ds, c('HISPDISCR_f_W58', 'KNOWDPORT_W58', 'RACESURV26_W58', 'F_PARTY_FINAL')) 

table_ds2 <- ds1 %>%
  filter(HISPDISCR_f_W58 != 'Refused', KNOWDPORT_W58 != 'Refused', RACESURV26_W58 != 'Refused',F_PARTY_FINAL != 'Refused', F_PARTY_FINAL != 'Something else') %>%
  group_by(HISPDISCR_f_W58, KNOWDPORT_W58, RACESURV26_W58, F_PARTY_FINAL) %>%
  summarize(Freq = n())

ggplot(table_ds2,
       aes(y = Freq, axis1 = HISPDISCR_f_W58, axis2 = KNOWDPORT_W58, axis3 = RACESURV26_W58, axis4 = F_PARTY_FINAL)) +
  geom_alluvium(aes(fill = F_PARTY_FINAL), width = 1/12) +
  geom_stratum(width = 1/12, fill = "black", color = "grey") +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("Discriminated against", "Deportation", "Identifies with other Latinos", "Political Preference"), expand = c(.05, .05)) +
  scale_fill_brewer(type = "qual", palette = "Set1") +
  ggtitle("Political Preference vs. Latino Experience") +
  theme_grey(16)
```


```{r}
#Question 3

table_ds6 <- ds %>%
  filter(LAN1_W58 != 'Refused', F_PARTY_FINAL != 'Refused', F_PARTY_FINAL != 'Something else') %>%
  group_by(LAN1_W58, F_PARTY_FINAL)%>%
  summarize(n = n()) %>%
  mutate(prop = n/sum(n))

ggplot(table_ds6, aes(x=LAN1_W58, y= prop, fill = F_PARTY_FINAL)) +geom_col(position ='dodge') +
  theme_grey(16)

table_ds7 <- ds %>%
  filter(LAN3_W58 != 'Refused', F_PARTY_FINAL != 'Refused', F_PARTY_FINAL != 'Something else') %>%
  group_by(LAN3_W58, F_PARTY_FINAL)%>%
  summarize(n = n()) %>%
  mutate(prop = n/sum(n))

ggplot(table_ds7, aes(x=LAN3_W58, y= prop, fill = F_PARTY_FINAL)) +geom_col(position ='dodge') +
  theme_grey(16)
```

